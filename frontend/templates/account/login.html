{% load static %}
{% load account socialaccount %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Login - AptiFy</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet"
  />
  <link rel="stylesheet" href="{% static 'css/style.css' %}" />
</head>
<body class="auth-page">
  <main class="auth-split">
    <section class="auth-section auth-logo-section" aria-label="AptiFy branding">
      <div class="auth-logo-container">
        <a class="auth-logo" href="/" aria-label="AptiFy home">
          <img src="{% static 'img/aptify-logo.jpg' %}" alt="AptiFy logo" width="320" height="320" />
        </a>
        <p class="auth-tagline">Focused learning, real progress</p>
      </div>
    </section>

    <section class="auth-section auth-form-section" aria-label="Sign in">
      <div class="auth-form-container">
        <div class="auth-header">
          <p class="auth-eyebrow">Welcome back</p>
          <h1 id="login-title">Sign in to AptiFy</h1>
          <p class="auth-subtitle">A calm workspace for consistent learning progress.</p>
        </div>

      {% get_providers as socialaccount_providers %}
      {% if socialaccount_providers %}
        {% for provider in socialaccount_providers %}
          {% if provider.id == "google" %}
            <a class="btn btn-google" href="{% provider_login_url provider.id process='login' %}">Continue with Google</a>
          {% endif %}
        {% endfor %}
      {% else %}
        <button class="btn btn-google" type="button" disabled>Continue with Google</button>
      {% endif %}

      <div class="auth-divider"><span>or</span></div>

      {% if form.errors %}
        <p class="form-error" role="alert">Please correct the errors below.</p>
      {% endif %}

      <form id="loginForm" class="auth-form" method="POST" action="{% url 'account_login' %}">
        {% csrf_token %}

        <label class="field">
          <span>{{ form.login.label }}</span>
          {{ form.login }}
        </label>

        <label class="field">
          <span>{{ form.password.label }}</span>
          <div class="password-field">
            {{ form.password }}
            <button type="button" class="password-toggle" data-target="{{ form.password.id_for_label }}">Show</button>
          </div>
        </label>

        {% if form.remember %}
        <label class="checkbox-field">
          {{ form.remember }}
          <span>{{ form.remember.label }}</span>
        </label>
        {% endif %}

        {% if redirect_field_value %}
        <input type="hidden" name="{{ redirect_field_name }}" value="{{ redirect_field_value }}" />
        {% endif %}

        <div class="auth-actions">
          <a class="text-link" href="{% url 'account_reset_password' %}">Forgot password?</a>
        </div>

        <button type="submit" class="btn btn-primary btn-block">Log in</button>
        <p id="formError" class="form-error" role="alert" hidden>Please fill in all required fields.</p>
      </form>

      <p class="auth-footer">
        New here?
        <a class="text-link" href="{% url 'account_signup' %}">Create an account</a>
      </p>
      </div>
    </section>
  </main>

  <script src="{% static 'js/script.js' %}"></script>
</body>
</html>
